---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Peter Dolenc"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning = FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

Pri projektu bom preučil, koliko in v kakšni obliki ljudje iz Evropske Uniji uporabljajo internet. Moja hipoteza je, da ljudje v bolj razvitih državah uporabljajo internet več in preko interneta tudi več kupujejo. Z analizo podatkov bom želel to hipotezo potrditi ali ovreči.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning = FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Uvozil sem podatke o državah EU v obliki CSV iz spletnega portala "eurostat" ter v obliki HTML z Wikipedije. Podatke imamo v 4 razpredelnicah v obliki *tidy data*.

Podatki v tidy data:
1. tabela: delež uporabnikov 
stolpci: država EU, leto, vrsta uporabe (doma, WI-FI), delež

2. tabela: nakupi
stolpci: država EU, leto, doma ali v tujini, delež

3. tabela: število uporabnikov Facebooka
stolpci: država EU, število uporabnikov Facebooka

4. tabela: razvitost držav
stolpci: država EU, število prebivalcev, BDP na prebivalca



<!-- *** -->

<!-- # Analiza in vizualizacija podatkov -->

<!-- ```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE} -->
<!-- source("vizualizacija/vizualizacija.r", encoding = "UTF-8") -->
<!-- ``` -->

Spodnji grafi prikazujejo krivuljo rasti uporabe interneta skozi čas. Prvi prikazuje rast po celotni Evropi, drugi v Slovaški, ki se kot država najbolj približuje povprečkju, tretji v Turčiji, kjer internet uporabljajo najmanj in zadnji Luksemburg, kjer internet uporabljajo največ.

***
```{r grafi, echo=FALSE, fig.align='center',  warning = FALSE, fig.cap='Graf uporabe interneta po letih za celotno Evropo, Slovaško, Turčijo in Luksembug'}
graf1<-ggplot()+geom_line(data=ide, aes(x=ide$leto, y=ide$`stevilo uporabnikov`, group=1), colour="red")+geom_line(data=ide, aes(x=ide$leto, y=ide$`stevilo uporabnikovwifi`, group=1), colour="blue")+
  ggtitle("Drzave EU skupaj")+labs(x="Leto", y="Delez uporabnikov v %")+coord_cartesian(ylim = c(0, 100))+geom_text(aes(82, x=2015), label="INTERNET", colour="red")+geom_text(aes(y=50, x=2015), label="WIFI", colour="blue")
graf4<-ggplot()+geom_line(data=slovaska, aes(x=slovaska$Leto, y=slovaska$`Uporaba interneta`, group=1), colour="red")+geom_line(data=slovaska, aes(x=slovaska$Leto, y=slovaska$`Uporaba WIFI`, group=1), colour="blue")+
  ggtitle("Slovaska")+labs(x="Leto", y="Delez uporabnikov v %")+coord_cartesian(ylim = c(0, 100)) 
graf3<-ggplot()+geom_line(data=turcija, aes(x=turcija$Leto, y=turcija$`Uporaba interneta`, group=1), colour="red")+geom_line(data=turcija, aes(x=turcija$Leto, y=turcija$`Uporaba WIFI`, group=1), colour="blue")+
  ggtitle("Turcija")+labs(x="Leto", y="Delez uporabnikov v %")+coord_cartesian(ylim = c(0, 100)) 
graf2<-ggplot()+geom_line(data=luxemburg, aes(x=luxemburg$Leto, y=luxemburg$`Uporaba interneta`, group=1), colour="red")+geom_line(data=luxemburg, aes(x=luxemburg$Leto, y=luxemburg$`Uporaba WIFI`, group=1), colour="blue")+
  ggtitle("Luksemburg")+labs(x="Leto", y="Delez uporabnikov v %")+coord_cartesian(ylim = c(0, 100)) 
grid.arrange(graf1, graf2, graf3, graf4)
```


